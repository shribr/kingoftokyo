/* Monster Selection Modal Styles */
/* Renamed from .setup-modal to .monster-selection-modal */
.cmp-monster-selection.monster-selection-modal { 
	position: fixed; inset: 0; display:flex; justify-content:center; align-items:center; padding:4vh 0 6vh; z-index:15050; /* Above blackout (7000) & profiles (<=15020) */
	background: rgba(0,0,0,.58); backdrop-filter: blur(3px); -webkit-backdrop-filter: blur(3px);
	transition: opacity .40s ease, transform .45s ease; will-change: opacity, transform; opacity:1; transform: translateY(0) scale(1); visibility:visible; pointer-events:auto;
	overflow:auto; width:100%; box-sizing:border-box;
}
.cmp-monster-selection.monster-selection-modal.demoted {
	/* Drop below profiles and remove backdrop to avoid a full-screen black state */
	z-index: 15010; /* below profiles 15020 */
	background: transparent;
	backdrop-filter: none; -webkit-backdrop-filter: none;
}
.cmp-monster-selection.monster-selection-modal.hidden { opacity:0; transform: translateY(24px) scale(.94); visibility:hidden; pointer-events:none; }


.cmp-monster-selection .setup-frame { 
	/* Dark, bold in-game panel styling (lightened slightly per feedback) */
	background: linear-gradient(180deg,#242424 0%, #1a1a1a 100%);
	border:4px solid #111; box-shadow: 14px 14px 0 #000, 0 0 0 2px #000 inset, 0 22px 42px -14px rgba(0,0,0,.85);
	border-radius:0; padding:24px 28px 40px; width: min(96vw, 1180px); display:flex; flex-direction:column; position:relative; overflow:hidden; margin:0 auto; /* ensure horizontal centering */
	/* Fix the frame height relative to the modal's vertical padding (4vh top + 6vh bottom) */
	height: calc(100vh - 10vh);
	max-height: calc(100vh - 10vh);
	color:#e6e6e6;
}
/* Internal scroll region so only monster list / sidebar scrolls, footer stays accessible */
.cmp-monster-selection .setup-body { flex:1 1 auto; min-height:0; overflow:hidden; padding-right:0; }
.cmp-monster-selection .setup-body > .cards-col { /* fix vertical space so pager stays put */ height:100%; }
.cmp-monster-selection .setup-body > .selection-sidebar { height:100%; overflow:auto; padding-right:4px; }
.cmp-monster-selection .cards-grid { max-height:100%; }
.cmp-monster-selection .selection-sidebar { max-height:100%; /* allow main scroll container to handle vertical scrolling */ overflow:visible; padding-right:4px; }
.cmp-monster-selection { color:#e6e6e6; }
.cmp-monster-selection .setup-title { font-family:'Bangers', cursive; font-size:52px; color:#FFD700; text-align:center; letter-spacing:2px; text-shadow: -3px -3px 0 #000, 3px -3px 0 #000, -3px 3px 0 #000, 3px 3px 0 #000; margin-bottom:12px; filter: drop-shadow(0 5px 0 #000); }
.cmp-monster-selection .setup-controls { display:grid; grid-template-columns: 1fr auto 1fr; grid-template-areas: 'left middle right'; gap:16px; align-items:center; margin-bottom:18px; }
.cmp-monster-selection .setup-controls [data-action="profiles"] { grid-area: left; justify-self: start; }
.cmp-monster-selection .setup-controls .player-count { grid-area: middle; justify-self:center; }
.cmp-monster-selection .setup-controls [data-action="random"] { grid-area: right; justify-self: end; }
.cmp-monster-selection { --control-h: 48px; --control-font: 20px; }
.cmp-monster-selection .setup-controls .player-count { justify-self:center; }
.cmp-monster-selection .pill-btn { background: linear-gradient(#fafafa,#e3e3e3); border:3px solid #111; border-radius:0; padding:0 18px; height: var(--control-h); font-weight:900; box-shadow:6px 6px 0 #000; cursor:pointer; letter-spacing:.5px; text-transform:uppercase; position:relative; transition:transform .18s ease, box-shadow .18s ease, filter .28s ease; color:#000; font-size: var(--control-font); font-family:'Bangers',cursive; display:inline-flex; align-items:center; justify-content:center; }
.cmp-monster-selection .pill-btn.gold { background: linear-gradient(var(--color-brand-gold,#ffd700), #ffb400); color:#000; }
.cmp-monster-selection .pill-btn:hover,
.cmp-monster-selection .start-btn:not([disabled]):hover { transform: translateY(-2px); box-shadow:5px 5px 0 #000; filter:brightness(1.04) saturate(1.05); }
.cmp-monster-selection .pill-btn:active,
.cmp-monster-selection .start-btn:not([disabled]):active { transform: translateY(0) scale(.97); box-shadow:4px 4px 0 #000; filter:brightness(.97); }
.cmp-monster-selection .pill-btn:focus-visible,
.cmp-monster-selection .start-btn:focus-visible { outline:3px solid #666; outline-offset:3px; }
.cmp-monster-selection .dropdown { position:relative; }
.cmp-monster-selection .dropdown-toggle { position:relative; display:flex; align-items:center; gap:10px; min-width:210px; justify-content:center; font-family:'Bangers',cursive; font-size: var(--control-font); letter-spacing:1px; padding:0 26px; height: var(--control-h); border:4px solid #000; border-radius:0; box-shadow:4px 4px 0 #000, 0 0 0 3px #222 inset; background:linear-gradient(180deg,#ffc21f 0%, #ff9500 55%, #ffae00 56%, #ffdf7a 100%); color:#000; transition:transform .18s ease, box-shadow .18s ease, filter .3s; }
.cmp-monster-selection .dropdown-toggle:hover { transform:translateY(-2px); filter:brightness(1.05) saturate(1.05); }
.cmp-monster-selection .dropdown.open .dropdown-toggle { transform:translateY(0) scale(.98); box-shadow:3px 3px 0 #000, 0 0 0 3px #222 inset; }
.cmp-monster-selection .dropdown .chev { font-weight:900; font-size:26px; line-height:1; display:inline-block; transition:transform .25s ease; text-shadow:none; }
.cmp-monster-selection .dropdown.open .dropdown-toggle .chev { transform:rotate(180deg); }
.cmp-monster-selection .dropdown-menu { position:absolute; top:108%; left:0; background:#fffef8; border:4px solid #000; box-shadow:8px 8px 0 #000; list-style:none; padding:8px 0 10px; margin:0; min-width:230px; display:block; opacity:0; transform:translateY(10px) scale(.96); pointer-events:none; transition:opacity .25s ease, transform .3s cubic-bezier(.22,1.15,.32,1); z-index:120; font-family:'Bangers',cursive; border-radius:0; }
.cmp-monster-selection .dropdown.open .dropdown-menu { opacity:1; transform:translateY(0) scale(1); pointer-events:auto; }
.cmp-monster-selection .dropdown-menu::before { content:""; position:absolute; top:-14px; left:34px; width:26px; height:14px; background:#fffef8; border:4px solid #000; border-bottom:none; clip-path:polygon(0 100%,50% 0,100% 100%); box-sizing:border-box; }
.cmp-monster-selection .dropdown-menu li { padding:12px 18px; cursor:pointer; font-weight:900; font-size: var(--control-font); color:#000; letter-spacing:.5px; text-transform:uppercase; position:relative; }
.cmp-monster-selection .dropdown-menu li+li { border-top:2px dotted rgba(0,0,0,.15); }
.cmp-monster-selection .dropdown-menu li:hover { background:linear-gradient(90deg,#ffe9a8,#ffd76a); }
.cmp-monster-selection .dropdown-menu li:active { background:linear-gradient(90deg,#ffc843,#ffad0a); }
.cmp-monster-selection .setup-body { display:grid; grid-template-columns: 1fr 320px; gap:28px; align-items:start; flex:1; overflow:hidden; min-height:0; }
.cmp-monster-selection .monster-pager { display:flex; align-items:center; justify-content:center; gap:14px; margin:0 0 12px; font-family:'Bangers',cursive; letter-spacing:1px; color:#fff; }
.cmp-monster-selection .cards-col { display:flex; flex-direction:column; flex:1; min-height:0; }
.cmp-monster-selection .cards-col .monster-pager { margin-top:18px; margin-bottom:0; }
.cmp-monster-selection .monster-pager .pager-btn { background:#fff4c2; border:3px solid #111; box-shadow:3px 3px 0 #000; padding:0 14px; height: var(--control-h); min-width: 48px; cursor:pointer; font-family:'Bangers',cursive; font-size: var(--control-font); color:#fff; line-height:1; transition:transform .18s ease, box-shadow .18s ease, filter .25s ease; border-radius:0; display:inline-flex; align-items:center; justify-content:center; text-shadow:-2px -2px 0 #000,2px -2px 0 #000,-2px 2px 0 #000,2px 2px 0 #000; }
.cmp-monster-selection .monster-pager .pager-btn:hover:not([disabled]) { transform:translate(-2px,-2px); box-shadow:5px 5px 0 #000; filter:brightness(1.05); }
.cmp-monster-selection .monster-pager .pager-btn:active:not([disabled]) { transform:translate(0,0); box-shadow:2px 2px 0 #000; }
.cmp-monster-selection .monster-pager .pager-btn[disabled] { opacity:.45; cursor:not-allowed; box-shadow:2px 2px 0 #000; }
.cmp-monster-selection .monster-pager .pager-status { font-size:20px; color:#fff; text-shadow:-2px -2px 0 #000,2px -2px 0 #000,-2px 2px 0 #000,2px 2px 0 #000; }

/* When viewport is very short, shift alignment upward so top is visible */
@media (max-height: 640px) {
	.cmp-monster-selection.monster-selection-modal { align-items:flex-start; }
}
.cmp-monster-selection .cards-grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:28px; padding:4px; overflow-y:auto; overscroll-behavior:contain; scrollbar-gutter: stable; flex:1; min-height:0; align-items:start; align-content:start; justify-content:start; }
.cmp-monster-selection .cards-grid::-webkit-scrollbar { width:10px; }
.cmp-monster-selection .cards-grid::-webkit-scrollbar-track { background:#161616; border:2px solid #111; box-shadow:inset 2px 2px 0 #000; }
.cmp-monster-selection .cards-grid::-webkit-scrollbar-thumb { background:#2a2a2a; border:2px solid #111; box-shadow:2px 2px 0 #000; }
.cmp-monster-selection .cards-grid::-webkit-scrollbar-thumb:hover { background:#333; }
.cmp-monster-selection [data-monster-card].is-unavailable { opacity:.6; filter: grayscale(100%); cursor:not-allowed; }
.cmp-monster-selection [data-monster-card][draggable="true"] { cursor: grab; }
.cmp-monster-selection [data-monster-card][draggable="true"]:active { cursor: grabbing; }
.cmp-monster-selection .monster-card { background:transparent; border:none; box-shadow:none; padding:0; position:relative; aspect-ratio: 4/3; display:flex; align-items:center; justify-content:center; cursor:pointer; }
.cmp-monster-selection .monster-card .stack { position:relative; width: 90%; height: 86%; }
/* Replace scratchy polaroid with bold dark tile */
.cmp-monster-selection .monster-card .polaroid { position:absolute; inset:0; background: var(--tile-bg, #2a2a2a); border:3px solid #111; box-shadow:6px 6px 0 #000, 0 0 0 2px #000 inset; display:flex; align-items:center; justify-content:center; transform:none; }
.cmp-monster-selection .monster-card .polaroid::before, .cmp-monster-selection .monster-card .polaroid::after { display:none; }
.cmp-monster-selection .monster-card .stack::before { display:none; }
.cmp-monster-selection .monster-card .photo {
	/* Show monster theme color with a subtle dark glaze so it still feels in-world */
	background: 
		linear-gradient(180deg, rgba(0,0,0,.22) 0%, rgba(0,0,0,.38) 100%),
		var(--tile-bg, #2a2a2a);
	border:2px solid #000; padding:10px; box-shadow: inset 0 0 0 2px #222;
}
.cmp-monster-selection .monster-card img { width:200px; max-width:100%; height:160px; object-fit:contain; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; filter:none; opacity:1; }
.cmp-monster-selection .monster-card .monster-name { position:absolute; bottom:4px; left:6px; right:6px; font-family:'Bangers',cursive; font-size:18px; color:#ffd400; text-shadow:-2px -2px 0 #000,2px -2px 0 #000,-2px 2px 0 #000,2px 2px 0 #000; text-align:center; letter-spacing:1px; }
.cmp-monster-selection .monster-card:hover { transform: translateY(-2px); }
.cmp-monster-selection .monster-card.selected img { filter: none; opacity:1; }
.cmp-monster-selection .selection-sidebar { display:flex; flex-direction:column; gap:16px; align-items:flex-start; }
.cmp-monster-selection .mini-list { display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:16px; width:100%; justify-items:center; }
.cmp-monster-selection .mini-card { width:140px; min-height:180px; border:3px solid #111; box-shadow:6px 6px 0 #000; display:flex; align-items:center; justify-content:flex-start; gap:8px; padding:14px 10px; background: var(--mini-bg, #1f1f1f); color:#e6e6e6; flex-direction:column; }
.cmp-monster-selection .mini-card.vertical { width:140px; min-height:180px; }
.cmp-monster-selection .mini-card.human-placeholder { background:#2a2a1a; align-items:center; justify-content:center; }
.cmp-monster-selection .mini-card.human-placeholder .mini-photo.placeholder { font-family:'Bangers',cursive; font-size:56px; color:#fff; text-shadow: -3px -3px 0 #000, 3px -3px 0 #000, -3px 3px 0 #000, 3px 3px 0 #000; display:flex; align-items:center; justify-content:center; width:80px; height:80px; border:none; background:transparent; box-shadow:none; }
.cmp-monster-selection .mini-card.human-placeholder .mini-name { display:none; }
.cmp-monster-selection .mini-card.human { background: var(--mini-bg, #26222a); }
.cmp-monster-selection .mini-card.cpu { background: #1e2a33; flex-direction:column; align-items:center; justify-content:center; padding-left:0; color:#e6e6e6; text-align:center; }
.cmp-monster-selection .mini-card.cpu.vertical { width:140px; min-height:180px; align-items:center; padding:14px 10px; }
.cmp-monster-selection .mini-card.droppable { outline:3px solid transparent; }
.cmp-monster-selection .mini-card.droppable.drag-over { outline-color:#ffb400; box-shadow:0 0 0 4px #000 inset, 6px 6px 0 #000; }
.cmp-monster-selection .mini-card[draggable="true"] { cursor: grab; }
.cmp-monster-selection .mini-card[draggable="true"]:active { cursor: grabbing; }
.cmp-monster-selection .mini-photo {
	width:70px; height:70px; border:2px solid #111;
	/* Let the monster theme color subtly tint the photo area if provided */
	background:
		linear-gradient(180deg, rgba(0,0,0,.20) 0%, rgba(0,0,0,.34) 100%),
		var(--mini-bg, #0f0f0f);
	display:flex; align-items:center; justify-content:center; box-shadow: inset 0 0 0 2px #222;
}
.cmp-monster-selection .mini-photo img { width:100%; height:100%; object-fit:contain; }
.cmp-monster-selection .mini-name { font-weight:900; font-size:15px; text-align:center; }
.cmp-monster-selection .cpu-label { font-family:'Bangers', cursive; font-size:36px; font-weight:900; color:#ffdf3d; text-shadow: -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000, 2px 2px 0 #000; }
.cmp-monster-selection .cpu-sub { display:none; }
.cmp-monster-selection .setup-footer { margin-top:16px; display:flex; align-items:center; justify-content:space-between; flex-shrink:0; }
.cmp-monster-selection .setup-footer .footer-actions { margin-left:auto; display:flex; gap:12px; align-items:center; }
.cmp-monster-selection .reset-link { background:#223246; border:3px solid #000; color:#fff; font-weight:900; cursor:pointer; text-decoration:none; display:inline-flex; align-items:center; justify-content:center; gap:6px; filter: drop-shadow(0 2px 0 #000); padding:0 16px; height: var(--control-h); font-size: var(--control-font); box-shadow:6px 6px 0 #000; border-radius:0; font-family:'Bangers',cursive; }
.cmp-monster-selection .start-btn { background:#3a3a3a; color:#e6e6e6; border:3px solid #111; box-shadow:8px 8px 0 #000; padding:0 20px; height: var(--control-h); font-size: var(--control-font); font-family:'Bangers',cursive; font-weight:900; letter-spacing:1px; cursor:not-allowed; transition:transform .18s ease, box-shadow .18s ease, filter .28s ease; position:relative; border-radius:0; display:inline-flex; align-items:center; justify-content:center; }
.cmp-monster-selection .start-btn:not([disabled]) { background:#2f7a2f; cursor:pointer; color:#fff; }
.cmp-monster-selection .setup-close { position:absolute; top:14px; right:14px; background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%); border:2px solid #000; color:#fff; width:48px; height:48px; font-size:26px; font-weight:700; line-height:1; display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:3px 3px 0 #000; border-radius:0; transition: transform .18s ease, box-shadow .18s ease, filter .25s ease; }
.cmp-monster-selection .setup-close:hover { transform:translateY(-2px); box-shadow:4px 4px 0 #000; filter:brightness(1.05); }
.cmp-monster-selection .setup-close:active { transform:translateY(0) scale(.96); box-shadow:2px 2px 0 #000; }
.cmp-monster-selection .setup-close:focus-visible { outline:3px solid #666; outline-offset:3px; }
@media (max-width: 1180px) { .cmp-monster-selection .setup-frame { width:min(96vw,1080px); } }
@media (max-width: 980px) { .cmp-monster-selection .setup-frame { padding:20px 22px 24px; } .cmp-monster-selection .setup-body { grid-template-columns: 1fr; } .cmp-monster-selection .selection-sidebar { align-items:center; } }
@media (max-width: 640px) { .cmp-monster-selection .setup-title { font-size:44px; } }

/* Mobile-first adaptations */
@media (max-width: 720px) {
	.cmp-monster-selection.monster-selection-modal { align-items: flex-start; padding: 0; }
	.cmp-monster-selection .setup-frame {
		width: 100vw; height: 100vh; max-height: 100vh; margin: 0;
		padding: 14px 12px 10px; border-width: 3px; box-shadow: 10px 10px 0 #000;
		display: flex; flex-direction: column;
	}
	.cmp-monster-selection .setup-title { font-size: 36px; margin-bottom: 8px; }
	/* Controls: dropdown first row, then two buttons side-by-side below */
	.cmp-monster-selection .setup-controls { display: grid; grid-template-columns: 1fr 1fr; grid-template-areas: 'dropdown dropdown' 'profiles random'; gap: 10px; margin-bottom: 12px; justify-items: stretch; }
	.cmp-monster-selection .setup-controls .player-count { grid-area: dropdown; }
	.cmp-monster-selection .setup-controls [data-action="profiles"] { grid-area: profiles; }
	.cmp-monster-selection .setup-controls [data-action="random"] { grid-area: random; }
	.cmp-monster-selection .setup-controls [data-action="profiles"] { justify-self: start; }
	.cmp-monster-selection .setup-controls [data-action="random"] { justify-self: end; }
	.cmp-monster-selection .dropdown-toggle { min-width: unset; font-size: var(--control-font); padding: 0 16px; height: var(--control-h); }
	.cmp-monster-selection .setup-body { gap: 16px; }
	/* Avoid scrolling: show one or two per page with pager; no internal scroll */
	.cmp-monster-selection .cards-grid { grid-template-columns: repeat(2, 1fr); gap: 16px; padding: 2px; overflow: hidden; }
	.cmp-monster-selection .monster-card img { width: 140px; height: 120px; }
	.cmp-monster-selection .selection-sidebar { align-items: stretch; }
	.cmp-monster-selection .mini-list { grid-template-columns: repeat(2, 1fr); gap: 10px; }
	.cmp-monster-selection .mini-card, .cmp-monster-selection .mini-card.vertical { width: auto; min-height: 150px; }
	.cmp-monster-selection .setup-footer { position: sticky; bottom: 0; left: 0; right: 0; padding: 10px 6px 6px; gap: 10px; background: linear-gradient(to top, rgba(28,28,28,.98), rgba(28,28,28,.65) 55%, rgba(28,28,28,0)); flex-direction: column; align-items: center; justify-content: center; }
	.cmp-monster-selection .setup-footer .footer-actions { order: 1; width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
	.cmp-monster-selection .reset-link { width: 100%; }
	.cmp-monster-selection .start-btn { width: 100%; }
}
/* Landscape small screens: tighten paddings, larger image area, no scroll */
@media (max-height: 480px) and (orientation: landscape) {
	.cmp-monster-selection.monster-selection-modal { padding: 0; }
	.cmp-monster-selection .setup-frame { padding: 10px 10px 8px; }
	.cmp-monster-selection .setup-title { font-size: 28px; margin-bottom: 6px; }
	.cmp-monster-selection .cards-grid { gap: 12px; overflow: hidden; }
	.cmp-monster-selection .monster-card .stack { width: 92%; height: 88%; }
	.cmp-monster-selection .monster-card img { height: 140px; }
}
@media (max-width: 480px) {
	.cmp-monster-selection .setup-controls { grid-template-columns: 1fr; grid-template-areas: 'dropdown' 'profiles' 'random'; }
	.cmp-monster-selection .cards-grid { grid-template-columns: 1fr; }
	.cmp-monster-selection .setup-title { font-size: 30px; }
	.cmp-monster-selection .pill-btn { padding: 8px 14px; }
}
