<!DOCTYPE html>
<html>
<head>
    <title>Power Card Analysis - Version Check</title>
    <style>
        body { 
            font-family: system-ui; 
            padding: 20px; 
            background: #1a1a2e;
            color: #eee;
        }
        .check { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px;
            border: 2px solid #444;
        }
        .pass { background: #1a4d2e; border-color: #22c55e; }
        .fail { background: #4d1a1a; border-color: #ef4444; }
        code { 
            background: #000; 
            padding: 2px 6px; 
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üîç Power Card Analysis Feature - Version Check</h1>
    <p>This page checks if the new power card analysis code is loaded.</p>
    
    <div id="checks"></div>
    
    <script type="module">
        const checks = document.getElementById('checks');
        
        function addCheck(name, passed, details) {
            const div = document.createElement('div');
            div.className = 'check ' + (passed ? 'pass' : 'fail');
            div.innerHTML = `
                <strong>${passed ? '‚úÖ' : '‚ùå'} ${name}</strong>
                <div style="margin-top: 8px; opacity: 0.9;">${details}</div>
            `;
            checks.appendChild(div);
        }
        
        // Check 1: Can we import the settings modal?
        try {
            const module = await import('./src/components/settings-modal/settings-modal.component.js');
            addCheck('Module Import', true, 'Settings modal component loaded successfully');
            
            // Check 2: Does openWinOddsQuickModal exist?
            if (module.openWinOddsQuickModal) {
                addCheck('Function Export', true, '<code>openWinOddsQuickModal</code> function is exported');
                
                // Check 3: Look for our new code in the function
                const funcString = module.openWinOddsQuickModal.toString();
                
                const hasSelectedPlayer = funcString.includes('selectedPlayer');
                addCheck('Selected Player Tracking', hasSelectedPlayer, 
                    hasSelectedPlayer ? 'Found <code>selectedPlayer</code> property in code' : 'selectedPlayer property NOT found');
                
                const hasPowerCardAnalysis = funcString.includes('renderPowerCardAnalysis');
                addCheck('Power Card Analysis Function', hasPowerCardAnalysis,
                    hasPowerCardAnalysis ? 'Found <code>renderPowerCardAnalysis</code> function call' : 'renderPowerCardAnalysis NOT found');
                
                const hasClickHandler = funcString.includes('data-player-id');
                addCheck('Player Row Click Handler', hasClickHandler,
                    hasClickHandler ? 'Found <code>data-player-id</code> attribute handling' : 'Click handler NOT found');
                
                const hasNewVersion = funcString.includes('NEW VERSION WITH POWER CARD ANALYSIS');
                addCheck('Version Marker', hasNewVersion,
                    hasNewVersion ? 'Console log marker found - this is the NEW version!' : 'This appears to be the OLD version (no marker)');
                
            } else {
                addCheck('Function Export', false, 'openWinOddsQuickModal function is NOT exported');
            }
            
        } catch (err) {
            addCheck('Module Import', false, `Error: ${err.message}`);
        }
        
        // Check 4: File timestamp
        const response = await fetch('./src/components/settings-modal/settings-modal.component.js', { method: 'HEAD' });
        const lastModified = response.headers.get('last-modified');
        addCheck('File Timestamp', true, `Last modified: ${lastModified || 'Unknown'}`);
        
        // Add instructions
        setTimeout(() => {
            const instructions = document.createElement('div');
            instructions.style.cssText = 'margin-top: 30px; padding: 20px; background: rgba(99,102,241,0.1); border: 2px solid rgba(99,102,241,0.3); border-radius: 8px;';
            instructions.innerHTML = `
                <h2 style="margin-top: 0;">üìã Next Steps</h2>
                <ol>
                    <li>If all checks pass (‚úÖ), the code is loaded correctly</li>
                    <li>Open the main game: <a href="index.html" style="color: #818cf8;">index.html</a></li>
                    <li>Press <code>Cmd + Shift + R</code> to hard refresh</li>
                    <li>Open browser console (Cmd + Option + I)</li>
                    <li>Look for log: <code>[WIN ODDS] ===== openWinOddsQuickModal called - NEW VERSION WITH POWER CARD ANALYSIS =====</code></li>
                    <li>Switch win odds modal to TABLE mode</li>
                    <li>Click any player row</li>
                    <li>See power card analysis appear!</li>
                </ol>
            `;
            document.body.appendChild(instructions);
        }, 500);
    </script>
</body>
</html>
