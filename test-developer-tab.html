<!DOCTYPE html>
<html>
<head>
    <title>Developer Tab Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #222; color: #fff; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #444; border-radius: 8px; }
        .success { border-color: #4CAF50; background: rgba(76, 175, 80, 0.1); }
        .error { border-color: #f44336; background: rgba(244, 67, 54, 0.1); }
        .info { border-color: #2196F3; background: rgba(33, 150, 243, 0.1); }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîß Developer Tab Integration Test</h1>
    
    <div class="test-section info">
        <h3>URL Hash Test</h3>
        <p>Current URL hash: <span id="current-hash"></span></p>
        <p>Developer mode: <span id="dev-mode-status"></span></p>
        <button onclick="testHashChange()">Toggle #dev</button>
    </div>

    <div class="test-section info">
        <h3>Settings Modal Test</h3>
        <button onclick="testSettingsModal()">Open Settings Modal</button>
        <button onclick="testDeveloperTab()">Test Developer Tab</button>
    </div>

    <div class="test-section info">
        <h3>Component Loading Test</h3>
        <button onclick="testDeveloperService()">Test Developer Service</button>
        <button onclick="testArchiveManager()">Test Archive Manager</button>
    </div>

    <div id="log" class="test-section">
        <h3>Test Log</h3>
        <div id="log-content"></div>
    </div>

    <script type="module">
        let logEl = document.getElementById('log-content');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.style.padding = '5px';
            div.style.margin = '2px 0';
            div.style.borderLeft = `3px solid ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'}`;
            div.style.paddingLeft = '10px';
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logEl.appendChild(div);
            logEl.scrollTop = logEl.scrollHeight;
        }

        function updateStatus() {
            document.getElementById('current-hash').textContent = window.location.hash || '(none)';
            const isDevMode = window.location.hash.includes('dev');
            document.getElementById('dev-mode-status').textContent = isDevMode ? '‚úÖ Enabled' : '‚ùå Disabled';
        }

        window.testHashChange = function() {
            if (window.location.hash.includes('dev')) {
                window.location.hash = '';
                log('Removed #dev from URL');
            } else {
                window.location.hash = '#dev';
                log('Added #dev to URL');
            }
            updateStatus();
        };

        window.testDeveloperService = async function() {
            try {
                const { developerFeatures } = await import('../src/services/developerFeaturesService.js');
                log('‚úÖ Developer service loaded successfully', 'success');
                log(`Developer mode: ${developerFeatures.isEnabled()}`, 'info');
            } catch (error) {
                log(`‚ùå Failed to load developer service: ${error.message}`, 'error');
            }
        };

        window.testSettingsModal = async function() {
            try {
                const { default: settingsModal } = await import('../src/components/settings-modal/settings-modal.component.js');
                log('‚úÖ Settings modal component loaded successfully', 'success');
                
                // Test creating the modal
                const container = document.createElement('div');
                container.className = 'cmp-settings-modal modal-shell';
                document.body.appendChild(container);
                
                const instance = settingsModal({});
                log('‚úÖ Settings modal instance created successfully', 'success');
                
                // Clean up
                setTimeout(() => container.remove(), 3000);
                
            } catch (error) {
                log(`‚ùå Failed to test settings modal: ${error.message}`, 'error');
            }
        };

        window.testDeveloperTab = function() {
            log('Testing developer tab visibility...');
            
            // Simulate dev mode change event
            document.dispatchEvent(new CustomEvent('devModeChanged', {
                detail: { enabled: window.location.hash.includes('dev') }
            }));
            
            log('‚úÖ Developer mode change event dispatched', 'success');
        };

        window.testArchiveManager = async function() {
            try {
                const { ArchiveManagerComponent } = await import('../src/ui/components/archiveManagerComponent.js');
                log('‚úÖ Archive manager component loaded successfully', 'success');
                
                const archiveManager = new ArchiveManagerComponent();
                log('‚úÖ Archive manager instance created successfully', 'success');
                
            } catch (error) {
                log(`‚ùå Failed to test archive manager: ${error.message}`, 'error');
            }
        };

        // Initialize
        updateStatus();
        window.addEventListener('hashchange', updateStatus);
        
        log('üöÄ Test page initialized');
        log('Click buttons above to test developer tab integration');
    </script>
</body>
</html>